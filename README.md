# Glofox: Classes Engine powered by Spring Boot

This project is a simple REST application for booking classes in a gym. It uses Spring Boot and Spring Data JPA.

Considerations:
* It supposes only a class with same name can be created on a given date.
* Bookings are for the gym, not for specific classes. Otherwise, the URL should be `/classes/{id}/bookings` instead of `/bookings`. In this case, prior existence of the `Class` must be checked.
* Only POST were implemented in both entities, as that was requested. Anyway one GET was implemented also (`GetMapping` for `/classes`)
* A H2 in memory database was used.
* Architecture: Layered architecture was used.
* Performance: in a real SQL database index for dates and name+dates is important to improve the performance  of validations.
* Tests were included for Service and for Controller layers

There are unit tests for the proposed use cases.

## Run the application

To run the application you'll need to generate the jar file containing the application with `mvn clean package`. It will generate the jar file into `./target` folder.

As SpringBoot 2.3 is used, is easy to add Docker image generation.

```shell
mvn spring-boot:build-image -Dspring-boot.build-image.imageName=jdottori/glofox-booking
```

After this can run with docker and port binding as:
```
docker run --rm -ti -p "8080:8080" jdottori/glofox-booking
```

## Test POST in Application

All `date`s should have the format `YYYY-MM-DD`.
If class or booking creation is successful, the created object (with its autogenerated ID) will be returned.


### Classes

Endpoint: `/classes`

Method: `POST`
This method expect a body with a JSON media-type which should contains 4 keys: `name`, `startDate`, `endDate` and `capacity`. 
Dates are inclusive in both ends, i.e. class between 2020-09-17 and 2020-09-20 has 4-days.

Class Post Example:
```shell
curl http://localhost:8080/classes -X POST -H 'Content-Type: application/json' -d '{
        "name": "Pilates",
        "startDate": "2020-09-17",
        "endDate": "2020-09-20",
        "capacity": "10"
    }' 
```

### Bookings

Endpoint: `/bookings`

Method: `POST`
This method expect a body with a JSON media-type which should contains: `name` and`date`. 
It is not implemented any check of class availability as it is not related with any particular class.

Booking Post Example:
```shell
curl http://localhost:8080/bookings -X POST -H 'Content-Type: application/json' -d '{
        "name": "Javier",
        "date": "2020-09-17"
    }' 
```